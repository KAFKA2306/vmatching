## 1. 目的・スコープ
- 目的：初回のみの価値観診断と自動要約・自動推薦により、回答途中からでも即時に対話へ到達できる常時稼働の婚活ワールドを提供する。[2][1]
- スコープ：PlayerDataによる自己データ永続化、112問選択式診断、中断再開、暫定ベクトルの逐次更新、30→6軸縮約、在室者の自動推薦リスト、1on1個室、可視化UI（手入力なし）。[1][2]
- 非スコープ：外部API/DB、相手不在への確実通知、画像の永続保存、他者のPlayerData書込、長文プロフィール運用、予約・メッセージの非同期機能。[2][1]

## 2. 前提・制約
- 技術基盤：Unity 2022 LTS＋VCC、SDK3 Worlds、UdonSharpで開発・運用する。[1][2]
- 永続化：PlayerDataは自分のデータのみを保存・復元し、公開は在室同意者の縮約情報（同期変数）に限る。[2][1]
- 画像：アバターの場内スナップは在室セッション中のみ表示し、永続化はしない（デフォルトはシルエット）。[1][2]
- 性能：相性計算は在室者の縮約ベクトルに限定し、分散処理と演算上限でフレーム負荷を抑制する。[2][1]

## 3. 利用者要件
- 初回のみアンケートに回答し、以後は自動保存の再開機能で続きを行えること。[1][2]
- 回答途中から自動要約・相性％・上位リストが表示され、即時に対話へ移行できること（暫定である旨を明示）。[2][1]
- 匿名・顔出し不要で、在室同意時のみ自分の縮約情報が公開されること。[1][2]

## 4. 機能要件（FR）
- FR-1 アンケート（112問・選択式・中断再開）：回答は逐次PlayerDataに保存し、未回答は0として管理する。[2][1]
- FR-2 ベクトル算出（暫定＋確定）：各回答確定時に暫定vv_0..29を更新し、完了時に正規化済みvv_0..29を確定保存する（-1.0〜+1.0）。[1][2]
- FR-3 公開スイッチ：在室中のみ公開ONで縮約6軸・価値観タグ等を同期配布し、OFFで即時非公開にする（暫定段階でも配布可のフラグと進捗％を含める）。[2][1]
- FR-4 自動推薦（暫定対応）：在室・公開同意者の縮約ベクトルからコサイン類似度を算出し、自分向け上位3名（N可変）をカードリストで提示する（回答進捗に応じて更新）。[1][2]
- FR-5 1on1個室：双方が同意すると個室へ自動テレポートし、15分タイマーでセッションを実施する。[2][1]
- FR-6 フィードバック：終了後に「また話したい/見送り」をワンタップ記録し、短期の再推薦抑制に用いる（自分のPlayerDataのみ）。[2][1]
- FR-7 可視化UI：推薦カードと詳細（価値観要約・相性レーダー）を自動生成のみで構成し、「暫定」バッジと進捗表示を備える。[2][1]

## 5. 非機能要件（NFR）
- 性能：PC≥72FPS、Quest≥60FPS、サイズPC<200MB/Quest<100MB、全再計算PC≤5秒・Quest≤10秒を目標とする（暫定更新時は増分計算で抑制）。[1][2]
- 信頼性：PlayerData読込失敗時は再試行とリセットUIを提供し、中断再開と暫定マッチングが恒常的に機能すること。[2][1]
- セキュリティ：生の回答・30軸ベクトルを他者に表示せず、6軸縮約・要約・進捗％のみ公開すること。[1][2]
- 保守性：設問・重み・縮約投影・要約テンプレは外部化（SO/Inspector）し、再ビルドなしで更新可能にする。[2][1]

## 6. データ仕様（PlayerData：自分のみ）
- diag_q_001..diag_q_112:int（0=未回答）で逐次保存する。[1][2]
- vv_0..vv_29:float（-1.0〜+1.0）を暫定更新し、完了時に確定保存する（暫定はローカル計算でも可）。[2][1]
- flags:int（公開ON/OFF・暫定公開可等）とact_last_active:intを保持する。[1][2]

## 7. 公開同期データ（在室・同意時）
- red_0..5:float（30→6軸縮約）、tags:string、headline:string、display_name:stringを配布する。[2][1]
- partial_flag:boolとprogress:int（0–112）またはprogress_pct:float（0–1）を追加し、暫定表示の説明性を確保する。[1][2]

## 8. 受入基準
- 回答途中で上位リストが表示・更新され、公開OFF時は第三者に一切露出しないこと。[2][1]
- 暫定→完了の移行でランキングが破綻せず、性能・サイズ要件（PC/Quest）を満たすこと。[1][2]
- 中断・再開・再訪で暫定マッチングが再現性高く機能し、1on1導線まで一貫して動作すること。[2][1]